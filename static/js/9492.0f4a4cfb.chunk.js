"use strict";(self.webpackChunkemilus=self.webpackChunkemilus||[]).push([[9492],{19492:function(e,r,t){t.r(r),t.d(r,{default:function(){return y}});var s=t(1413),n=t(74165),a=t(15861),i=t(29439),o=t(72791),l=t(74569),c=t.n(l),d=t(17145),u=t(10916),m=t(77027),p=t(87309),h=t(91082),f=t(376),Z=t(63345),x=t(11990),w=t(32014),g=t(38999),v=t(80184),y=(d.Z.Option,function(){var e=(0,o.useState)(!1),r=(0,i.Z)(e,2),t=r[0],l=r[1],y=(0,o.useState)(!1),j=(0,i.Z)(y,2),P=j[0],k=j[1],N=(0,o.useState)(null),b=(0,i.Z)(N,2),C=b[0],I=b[1],F=(0,o.useState)([]),S=(0,i.Z)(F,2),E=S[0],U=S[1],A=(0,o.useState)([]),R=(0,i.Z)(A,2),_=R[0],L=R[1],q=(0,o.useState)([]),V=(0,i.Z)(q,2),z=V[0],O=V[1],T=u.Z.useForm(),H=(0,i.Z)(T,1)[0],M=(0,o.useState)(!1),B=(0,i.Z)(M,2),D=B[0],J=B[1],K=(0,o.useState)(!1),G=(0,i.Z)(K,2),Q=G[0],W=G[1],X=u.Z.useForm(),Y=(0,i.Z)(X,1)[0],$=(0,o.useState)([]),ee=(0,i.Z)($,2),re=ee[0],te=ee[1],se=(0,o.useState)(""),ne=(0,i.Z)(se,2),ae=ne[0],ie=ne[1];(0,o.useEffect)((function(){ce(),de(),oe()}),[]),(0,o.useEffect)((function(){P&&C?(H.setFieldsValue({firstName:C.firstName,lastName:C.lastName,email:C.email,role:C.roleName,isAdministrator:C.au_is_administrator}),J(1===C.au_is_administrator)):(H.resetFields(),J(!1))}),[P,C,H]),(0,o.useEffect)((function(){if(ae){var e=E.filter((function(e){return e.firstName.toLowerCase().includes(ae.toLowerCase())||e.lastName.toLowerCase().includes(ae.toLowerCase())||e.email.toLowerCase().includes(ae.toLowerCase())}));L(e)}else L(E)}),[ae,E]);var oe=function(){var e=JSON.parse(localStorage.getItem("permissions"));te(e||[])},le=function(e,r){if(!re||0===re.length)return!0;var t=re.find((function(r){return r.menu_id===e}));return!!t&&1===t[r]},ce=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c().get("http://159.89.167.135:3000/api/admin/getUsers");case 3:r=e.sent,U(r.data.data),L(r.data.data),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error fetching users:",e.t0),m.ZP.error("Failed to fetch users");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c().get("http://159.89.167.135:3000/api/admin/getRole");case 3:r=e.sent,O(r.data.data),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching roles:",e.t0),m.ZP.error("Failed to fetch roles");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ue=function(){l(!t),k(!1),I(null),H.resetFields()},me=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c().post("http://159.89.167.135:3000/api/admin/createUser",(0,s.Z)((0,s.Z)({},r),{},{au_is_administrator:D?1:0}));case 3:m.ZP.success("User added successfully"),ce(),ue(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),e.t0.response&&e.t0.response.data&&e.t0.response.data.message?m.ZP.error(e.t0.response.data.message):m.ZP.error("An unexpected error occurred");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(r){return e.apply(this,arguments)}}(),pe=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c().put("http://159.89.167.135:3000/api/admin/updateUser/".concat(C.id),(0,s.Z)((0,s.Z)({},r),{},{au_is_administrator:D?1:0}));case 3:m.ZP.success("User updated successfully"),ce(),ue(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error updating user:",e.t0),m.ZP.error("Failed to update user");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(r){return e.apply(this,arguments)}}(),he=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c().delete("http://159.89.167.135:3000/api/admin/deleteUser/".concat(r));case 3:m.ZP.success("User deleted successfully"),ce(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error deleting user:",e.t0),m.ZP.error("Failed to delete user");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(r){return e.apply(this,arguments)}}(),fe=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c().put("http://159.89.167.135:3000/api/admin/changePassword/".concat(C.id),{password:r.password});case 3:m.ZP.success("Password changed successfully"),W(!1),Y.resetFields(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error changing password:",e.t0),m.ZP.error("Failed to change password");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(r){return e.apply(this,arguments)}}(),Ze=[{title:"S.No",dataIndex:"id",key:"id"},{title:"First Name",dataIndex:"firstName",key:"firstName"},{title:"Last Name",dataIndex:"lastName",key:"lastName"},{title:"Email",dataIndex:"email",key:"email"},{title:"Role",dataIndex:"roleName",key:"roleName"},{title:"Actions",key:"actions",render:function(e,r){return(0,v.jsxs)("span",{children:[le(9,"edit")&&(0,v.jsx)(p.ZP,{type:"link",onClick:function(){return function(e){k(!0),I(e),l(!0)}(r)},children:"Edit"}),le(9,"edit")&&(0,v.jsx)(p.ZP,{type:"link",icon:(0,v.jsx)(g.Z,{}),onClick:function(){return function(e){I(e),W(!0)}(r)},children:"Change Password"}),le(9,"delete")&&(0,v.jsx)(h.Z,{title:"Are you sure to delete this user?",onConfirm:function(){return he(r.id)},children:(0,v.jsx)(p.ZP,{type:"link",danger:!0,children:"Delete"})})]})}}];return(0,v.jsxs)("div",{className:"admin-users",children:[(0,v.jsxs)("div",{className:"header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,v.jsx)("h2",{children:"Admin Users"}),(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,v.jsx)(f.Z,{placeholder:"Search users",value:ae,onChange:function(e){return ie(e.target.value)},style:{marginRight:16,width:200,borderRadius:0}}),le(9,"add")&&(0,v.jsx)(p.ZP,{type:"primary",onClick:ue,style:{borderRadius:0},children:"Add User"})]})]}),(0,v.jsx)(Z.Z,{columns:Ze,dataSource:_,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!1,position:["bottomRight"]}}),(0,v.jsx)(x.Z,{title:P?"Edit User":"Add New User",visible:t,onCancel:ue,footer:null,children:(0,v.jsxs)(u.Z,{form:H,onFinish:P?pe:me,children:[(0,v.jsxs)(u.Z.Item,{label:"Name",style:{marginBottom:0},children:[(0,v.jsx)(u.Z.Item,{name:"firstName",rules:[{required:!0,message:"Please enter the first name"}],style:{display:"inline-block",width:"calc(50% - 8px)"},children:(0,v.jsx)(f.Z,{placeholder:"First Name"})}),(0,v.jsx)(u.Z.Item,{name:"lastName",rules:[{required:!0,message:"Please enter the last name"}],style:{display:"inline-block",width:"calc(50% - 8px)",marginLeft:"16px"},children:(0,v.jsx)(f.Z,{placeholder:"Last Name"})})]}),(0,v.jsx)(u.Z.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter a valid email",type:"email"}],children:(0,v.jsx)(f.Z,{})}),!P&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u.Z.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter the password"}],children:(0,v.jsx)(f.Z.Password,{})}),(0,v.jsx)(u.Z.Item,{name:"confirmPassword",label:"Confirm Password",dependencies:["password"],rules:[{required:!0,message:"Please confirm the password"},function(e){var r=e.getFieldValue;return{validator:function(e,t){return t&&r("password")!==t?Promise.reject(new Error("The passwords do not match!")):Promise.resolve()}}}],children:(0,v.jsx)(f.Z.Password,{})})]}),(0,v.jsx)(u.Z.Item,{name:"isAdministrator",valuePropName:"checked",children:(0,v.jsx)(w.Z,{checked:D,onChange:function(e){return J(e.target.checked)},children:"Administrator"})}),!D&&(0,v.jsx)(u.Z.Item,{name:"role",label:"Role",rules:[{required:!D,message:"Please select a role"}],children:(0,v.jsx)(d.Z,{placeholder:"Select Role",children:z.map((function(e){return(0,v.jsx)(d.Z.Option,{value:e.id,children:e.rm_role_name},e.id)}))})}),(0,v.jsxs)(u.Z.Item,{className:"form-buttons",style:{textAlign:"right"},children:[(0,v.jsx)(p.ZP,{type:"default",onClick:ue,style:{marginRight:8},children:"Cancel"}),(0,v.jsx)(p.ZP,{type:"primary",htmlType:"submit",children:P?"Update User":"Add User"})]})]})}),(0,v.jsx)(x.Z,{title:"Change Password",visible:Q,onCancel:function(){return W(!1)},footer:null,children:(0,v.jsxs)(u.Z,{form:Y,onFinish:fe,children:[(0,v.jsx)(u.Z.Item,{name:"password",label:"New Password",rules:[{required:!0,message:"Please enter the new password"}],children:(0,v.jsx)(f.Z.Password,{})}),(0,v.jsx)(u.Z.Item,{name:"confirmPassword",label:"Confirm Password",dependencies:["password"],rules:[{required:!0,message:"Please confirm the password"},function(e){var r=e.getFieldValue;return{validator:function(e,t){return t&&r("password")!==t?Promise.reject(new Error("The passwords do not match!")):Promise.resolve()}}}],children:(0,v.jsx)(f.Z.Password,{})}),(0,v.jsxs)(u.Z.Item,{className:"form-buttons",style:{textAlign:"right"},children:[(0,v.jsx)(p.ZP,{type:"default",onClick:function(){return W(!1)},style:{marginRight:8},children:"Cancel"}),(0,v.jsx)(p.ZP,{type:"primary",htmlType:"submit",children:"Change Password"})]})]})})]})})},38999:function(e,r,t){t.d(r,{Z:function(){return l}});var s=t(1413),n=t(72791),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},i=t(8711),o=function(e,r){return n.createElement(i.Z,(0,s.Z)((0,s.Z)({},e),{},{ref:r,icon:a}))};o.displayName="LockOutlined";var l=n.forwardRef(o)}}]);
//# sourceMappingURL=9492.0f4a4cfb.chunk.js.map