"use strict";(self.webpackChunkemilus=self.webpackChunkemilus||[]).push([[4754],{79644:function(e,n,t){t.r(n),t.d(n,{default:function(){return g}});var r=t(1413),a=t(74165),c=t(15861),s=t(29439),i=t(72791),l=t(77027),o=t(376),u=t(87309),d=t(91082),f=t(63345),p=t(11990),h=t(32014),m=t(74569),v=t.n(m),x=t(92414),Z=t(80184),g=function(){var e=(0,i.useState)([]),n=(0,s.Z)(e,2),t=n[0],m=n[1],g=(0,i.useState)(""),j=(0,s.Z)(g,2),y=j[0],k=j[1],w=(0,i.useState)(null),b=(0,s.Z)(w,2),C=b[0],S=b[1],P=(0,i.useState)(""),R=(0,s.Z)(P,2),_=R[0],E=R[1],N=(0,i.useState)(!1),z=(0,s.Z)(N,2),A=z[0],I=z[1],L=(0,i.useState)(!1),M=(0,s.Z)(L,2),F=M[0],O=M[1],B=(0,i.useState)([]),D=(0,s.Z)(B,2),J=D[0],T=D[1],V=(0,i.useState)(null),H=(0,s.Z)(V,2),K=H[0],W=H[1],q=(0,i.useState)({}),G=(0,s.Z)(q,2),Q=G[0],U=G[1],X=(0,i.useState)([]),Y=(0,s.Z)(X,2),$=Y[0],ee=Y[1],ne=(0,i.useState)(""),te=(0,s.Z)(ne,2),re=te[0],ae=te[1];(0,i.useEffect)((function(){le(),ie(),ce()}),[]);var ce=function(){var e=JSON.parse(localStorage.getItem("permissions"));ee(e||[])},se=function(e,n){if(!$||0===$.length)return!0;var t=$.find((function(n){return n.menu_id===e}));return!!t&&1===t[n]},ie=function(){var e=localStorage.getItem("user_menu");if(e)try{var n=JSON.parse(e);T(n)}catch(t){console.error("Error parsing menu:",t)}else console.warn("No 'user_menu' found in localStorage."),T([])},le=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v().get("http://159.89.167.135:3000/api/admin/getRole");case 3:n=e.sent,m(n.data.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching roles:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y.trim()){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,v().post("http://159.89.167.135:3000/api/admin/addRole",{role_name:y});case 5:l.ZP.success("Role added successfully"),k(""),I(!1),le(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),e.t0.response&&e.t0.response.data&&e.t0.response.data.message?l.ZP.error(e.t0.response.data.message):l.ZP.error("An unexpected error occurred");case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),ue=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.trim()){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,v().put("http://159.89.167.135:3000/api/admin/updateRole/".concat(C),{role_name:_});case 5:l.ZP.success("Role updated successfully"),S(null),E(""),le(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),e.t0.response&&e.t0.response.data&&e.t0.response.data.message?l.ZP.error(e.t0.response.data.message):l.ZP.error("An unexpected error occurred");case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v().delete("http://159.89.167.135:3000/api/admin/deleteRole/".concat(n));case 3:l.ZP.success("Role deleted successfully"),le(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),l.ZP.error("Error deleting role");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n){return e.apply(this,arguments)}}(),fe=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;U((function(c){var s,i,o,u=(0,r.Z)({},c);if(t&&a&&(null===(s=u[a])||void 0===s||!s.view))return l.ZP.warning('Please select the master menu "'.concat(a,'" first.')),u;(u[e]||(u[e]={}),u[e][n]=!u[e][n],u[e].view||"view"!==n||t)||(null===(i=J.find((function(n){return n.name===e})))||void 0===i||null===(o=i.submenu)||void 0===o||o.forEach((function(e){u[e.name]={view:!1,add:!1,edit:!1,delete:!1}})));return u}))},pe=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("seleted role",n),W(n),e.prev=2,e.next=5,v().get("http://159.89.167.135:3000/api/admin/getRolePermissions/".concat(n.id));case 5:t=e.sent,U(t.data.permissions||{}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error("Error loading permissions:",e.t0);case 12:O(!0);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(n){return e.apply(this,arguments)}}(),he=function(){O(!1),U({}),W(null)},me=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!K){e.next=11;break}return e.prev=1,e.next=4,v().post("http://159.89.167.135:3000/api/admin/setRolePermission",{role_id:K.id,permissions:Q});case 4:l.ZP.success("Permissions added successfully"),le(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),l.ZP.error("Error updating permissions");case 11:he();case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),ve=t.filter((function(e){return e.rm_role_name.toLowerCase().includes(re.toLowerCase())})),xe=[{title:"ID",dataIndex:"id",key:"id"},{title:"Role Name",dataIndex:"rm_role_name",key:"rm_role_name",render:function(e,n){return C===n.id?(0,Z.jsx)(o.Z,{value:_,onChange:function(e){return E(e.target.value)},onPressEnter:ue}):e}},{title:"Actions",key:"actions",render:function(e,n){return C===n.id?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(u.ZP,{type:"primary",onClick:ue,style:{marginRight:8},children:"Save"}),(0,Z.jsx)(u.ZP,{onClick:function(){return S(null)},children:"Cancel"})]}):(0,Z.jsxs)(Z.Fragment,{children:[se(7,"edit")&&(0,Z.jsx)(x.Z,{style:{fontSize:"20px",marginRight:"8px",cursor:"pointer"},onClick:function(){return pe(n)}}),se(7,"edit")&&(0,Z.jsx)(u.ZP,{type:"link",onClick:function(){return S((e=n).id),void E(e.rm_role_name);var e},style:{marginRight:8},children:"Edit"}),se(7,"delete")&&(0,Z.jsx)(d.Z,{title:"Are you sure to delete this role?",onConfirm:function(){return de(n.id)},children:(0,Z.jsx)(u.ZP,{type:"link",danger:!0,children:"Delete"})})]})}}];return(0,Z.jsxs)("div",{className:"role-master-container",children:[(0,Z.jsxs)("div",{className:"header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,Z.jsx)("h2",{children:"Role Master"}),(0,Z.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,Z.jsx)(o.Z,{placeholder:"Search roles",value:re,onChange:function(e){return ae(e.target.value)},style:{marginRight:16,width:200,borderRadius:0}}),se(7,"add")&&(0,Z.jsx)(u.ZP,{type:"primary",onClick:function(){return I(!0)},style:{borderRadius:0},children:"Add Role Master"})]})]}),(0,Z.jsx)(f.Z,{columns:xe,dataSource:ve,rowKey:"id",pagination:{pageSize:10}}),(0,Z.jsx)(p.Z,{title:"Add New Role",visible:A,onOk:oe,onCancel:function(){return I(!1)},okText:"Add",cancelText:"Cancel",children:(0,Z.jsx)(o.Z,{placeholder:"Enter role name",value:y,onChange:function(e){return k(e.target.value)}})}),(0,Z.jsx)(p.Z,{title:"".concat(null===K||void 0===K?void 0:K.rm_role_name," Permissions"),visible:F,onOk:me,onCancel:he,footer:[(0,Z.jsx)(u.ZP,{onClick:he,children:"Cancel"},"cancel"),(0,Z.jsx)(u.ZP,{type:"primary",onClick:me,children:"Save"},"save")],children:(0,Z.jsxs)("table",{className:"permissions-table",style:{width:"100%"},children:[(0,Z.jsx)("thead",{children:(0,Z.jsxs)("tr",{style:{backgroundColor:"white"},children:[(0,Z.jsx)("th",{children:"Permission"}),(0,Z.jsx)("th",{children:"View"}),(0,Z.jsx)("th",{children:"Add"}),(0,Z.jsx)("th",{children:"Edit"}),(0,Z.jsx)("th",{children:"Delete"})]})}),(0,Z.jsx)("tbody",{children:J&&J.length>0?J.map((function(e,n){return(0,Z.jsxs)(i.Fragment,{children:[(0,Z.jsxs)("tr",{style:{fontWeight:"bold"},children:[(0,Z.jsx)("td",{children:e.name}),["view","add","edit","delete"].map((function(n){var t;return(0,Z.jsx)("td",{children:(0,Z.jsx)(h.Z,{checked:(null===(t=Q[e.name])||void 0===t?void 0:t[n])||!1,onChange:function(){return fe(e.name,n)}})},n)}))]}),e.submenu&&e.submenu.length>0&&e.submenu.map((function(t,r){return(0,Z.jsxs)("tr",{children:[(0,Z.jsx)("td",{style:{paddingLeft:"20px"},children:t.name}),["view","add","edit","delete"].map((function(n){var r,a;return(0,Z.jsx)("td",{children:(0,Z.jsx)(h.Z,{checked:(null===(r=Q[t.name])||void 0===r?void 0:r[n])||!1,onChange:function(){return fe(t.name,n,!0,e.name)},disabled:!(null!==(a=Q[e.name])&&void 0!==a&&a.view)})},n)}))]},"".concat(n,"-").concat(r))}))]},n)})):(0,Z.jsx)("tr",{children:(0,Z.jsx)("td",{colSpan:"5",children:"No menu items available"})})})]})})]})}},37557:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(1413),a=t(72791),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},s=t(8711),i=function(e,n){return a.createElement(s.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:c}))};i.displayName="CheckCircleFilled";var l=a.forwardRef(i)},10187:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(1413),a=t(72791),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},s=t(8711),i=function(e,n){return a.createElement(s.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:c}))};i.displayName="ExclamationCircleFilled";var l=a.forwardRef(i)},92414:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(1413),a=t(72791),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"},s=t(8711),i=function(e,n){return a.createElement(s.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:c}))};i.displayName="SettingOutlined";var l=a.forwardRef(i)}}]);
//# sourceMappingURL=4754.453ef585.chunk.js.map